<!DOCTYPE html>
<html>
  <head>
    <title>SalSA</title>
    <link rel="icon" type="image/png" href="images/salsa.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <link rel="stylesheet" href="css/main.css">
  </head>
  <body>
    <section class="hero is-dark is-medium">
      <div class="hero-head">
        <nav class="navbar is-dark">
          <div class="container">
            <div class="navbar-brand">
              <a class="navbar-item" href="">
                <img src="images/salsa.png">
              </a>
              <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="mainNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
              </a>
            </div>
            <div id="mainNav" class="navbar-menu">
              <div class="navbar-end">
                <a class="navbar-item">
                  Analyze
                </a>
                <a class="navbar-item">
                  About
                </a>
                <a class="navbar-item">
                  Examples
                </a>
              </div>
            </div>
          </div>
        </nav>
      </div>
      <div class="hero-body">
        <div class="container is-dark">
          <h1 class="title salsa-has-text-primary">
            SalSA
          </h1>
          <h2 class="subtitle">
            Static Malware Analysis for PE files (<span class="is-family-monospace">.exe</span>, <span class="is-family-monospace">.dll</span>, and <span class="is-family-monospace">.sys</span>)
          </h2>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <h1 class="title has-text-centered has-text-weight-semibold">
          Add your file here:
        </h1>
        <div class="file is-centered is-boxed">
          <label class="file-label">
            <div class="control">
              <input id="pe-uploader" class="file-input" type="file">
              <span class="file-cta">
                <span class="file-icon">
                  <i class="fas fa-upload"></i>
                </span>
                <span class="file-label">
                  Choose a file...
                </span>
              </span>
            </div>
          </label>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <div class="columns">
          <div class="column has-text-centered">
            <span class="icon is-large has-text-success">
              <i class="fas fa-child fa-3x"></i>
            </span>
            <p class="title">Standalone</p>
            <p class="subtitle">All parsing is done <strong>locally</strong> in your browser (nothing is sent to a server)</p>
          </div>
          <div class="column has-text-centered">
            <span class="icon is-large has-text-info">
              <i class="fas fa-code fa-3x"></i>
            </span>
            <p class="title">Free</p>
            <p class="subtitle">Completely open source on <a target="_blank" href="https://github.com/a-rey/SalSA">Github</a></p>
          </div>
          <div class="column has-text-centered">
            <span class="icon is-large has-text-danger">
              <i class="fas fa-bug fa-3x"></i>
            </span>
            <p class="title">Modern</p>
            <p class="subtitle">Applies <a href="">rules</a> to check for the <strong>latest</strong> Malware behaviors</p>
          </div>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <p class="title">Examples</p>
        <p class="subtitle">TODO: need a simple video of usage</p>
      </div>
    </section>
    <script defer="" type="text/javascript" src="https://use.fontawesome.com/releases/v5.8.2/js/all.js"></script>
    <script defer="" type="text/javascript" src="js/pe.js"></script>
    <script defer="" type="text/javascript" src="js/main.js"></script>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- TEMPLATES: -->
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
    <!-- Report Navigation Bar: -->
    <script id="report-navbar-template" type="text/template">
      <nav class="navbar is-dark is-fixed-top">
        <div class="navbar-brand">
          <a class="navbar-item" href="">
            <img src="images/salsa.png">
          </a>
          <div class="navbar-burger burger" data-target="reportNav">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
        <div class="navbar-menu" id="reportNav">
          <div class="navbar-start">
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link">Report</a>
              <div class="navbar-dropdown">
                <a data-target="report-overview" class="salsa-pane-link navbar-item is-active">Overview</a>
                <hr class="navbar-divider">
                <a data-target="report-dos" class="salsa-pane-link navbar-item">DOS Header</a>
                <a data-target="report-pe" class="salsa-pane-link navbar-item">PE Header</a>
                <a data-target="report-image" class="salsa-pane-link navbar-item">Image Header</a>
                <a data-target="report-data-directories" class="salsa-pane-link navbar-item">Data Directories</a>
                <a data-target="report-sections" class="salsa-pane-link navbar-item">Sections</a>
                <hr class="navbar-divider">
                <a data-target="report-alerts" class="salsa-pane-link navbar-item">Alerts</a>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </script>
    <!-- Report Overview Pane: -->
    <script id="report-overview-template" type="text/template">
      <section id="report-overview" class="section">
        <div class="container">
          <h1 class="title">Information</h1>
          <table class="table is-striped is-hoverable is-fullwidth">
            <tbody>
              <tr>
                <td>File Name</td>
                <td><span class="is-family-monospace">{{FILENAME}}</span></td>
              </tr>
              <tr>
                <td>File Size</td>
                <td>
                  <span class="is-family-monospace">{{FILESIZE_READABLE}}</span>
                  <span class="is-family-monospace">({{FILESIZE_ACTUAL}}</span> bytes)
                </td>
              </tr>
              <tr>
                <td>Compilation Timestamp</td>
                <td>
                  <span class="is-family-monospace">{{TIMESTAMP}}</span>
                </td>
              </tr>
              <tr>
                <td>Target Machine Type</td>
                <td><span class="is-family-monospace">{{MACHINE_TYPE}}</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <hr>
        <div class="container">
          <h1 class="title">Hashes</h1>
          <table class="table is-striped is-hoverable is-fullwidth">
            <thead>
              <tr>
                <th>Type</th>
                <th>Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>SHA-1</td>
                <td>
                  <span class="is-family-monospace">{{SHA1}}</span>
                  <a target="_blank" href="https://www.virustotal.com/gui/file/{{SHA1}}" class="button is-danger is-small">
                    <span class="icon">
                      <i class="fas fa-search"></i>
                    </span>
                    <span>VirusTotal</span>
                  </a>
                </td>
              </tr>
              <tr>
                <td>SHA-256</td>
                <td>
                  <span class="is-family-monospace">{{SHA256}}</span>
                  <a target="_blank" href="https://www.virustotal.com/gui/file/{{SHA256}}" class="button is-danger is-small">
                    <span class="icon">
                      <i class="fas fa-search"></i>
                    </span>
                    <span>VirusTotal</span>
                  </a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </script>
    <!-- Report PE Header Pane: -->
    <script id="report-pe-template" type="text/template">
      <section id="report-pe" class="section is-hidden">
        <div class="container">
          <h1 class="title">PE Header (Also Called COFF Header)
            <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#coff-file-header-object-and-image" class="button is-small is-link is-rounded">
              <span class="icon is-small">
                <i class="fas fa-question"></i>
              </span>
            </a>
          </h1>
          <table class="table is-striped is-hoverable is-fullwidth">
            <tbody>
              <tr>
                <td>Signature</td>
                <td><span class="is-family-code">{{Signature}}</span></td>
              </tr>
              <tr>
                <td>Machine
                  <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#machine-types" class="button is-small is-link is-rounded">
                    <span class="icon is-small">
                      <i class="fas fa-question"></i>
                    </span>
                  </a>
                </td>
                <td><span class="is-family-code">{{Machine}}</span></td>
              </tr>
              <tr>
                <td>NumberOfSections</td>
                <td><span class="is-family-code">{{NumberOfSections}}</span></td>
              </tr>
              <tr>
                <td>TimeDateStamp</td>
                <td><span class="is-family-code">{{TimeDateStamp}}</span></td>
              </tr>
              <tr>
                <td>PointerToSymbolTable</td>
                <td><span class="is-family-code">{{PointerToSymbolTable}}</span></td>
              </tr>
              <tr>
                <td>NumberOfSymbols</td>
                <td><span class="is-family-code">{{NumberOfSymbols}}</span></td>
              </tr>
              <tr>
                <td>SizeOfOptionalHeader</td>
                <td><span class="is-family-code">{{SizeOfOptionalHeader}}</span></td>
              </tr>
              <tr>
                <td>Characteristics
                  <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#characteristics" class="button is-small is-link is-rounded">
                    <span class="icon is-small">
                      <i class="fas fa-question"></i>
                    </span>
                  </a>
                </td>
                <td><span class="is-family-code">{{Characteristics}}</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </script>
    <!-- Report IMAGE Header Pane: -->
    <script id="report-image-template" type="text/template">
      <section id="report-image" class="section is-hidden">
        <div class="container">
          <h1 class="title">Image "Optional" Header
            <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#optional-header-standard-fields-image-only" class="button is-small is-link is-rounded">
              <span class="icon is-small">
                <i class="fas fa-question"></i>
              </span>
            </a>
          </h1>
          <table class="table is-striped is-hoverable is-fullwidth">
            <tbody>
              <tr>
                <td>Magic
                  <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#optional-header-image-only" class="button is-small is-link is-rounded">
                    <span class="icon is-small">
                      <i class="fas fa-question"></i>
                    </span>
                  </a>
                </td>
                <td><span class="is-family-code">{{Magic}}</span></td>
              </tr>
              <tr>
                <td>MajorLinkerVersion</td>
                <td><span class="is-family-code">{{MajorLinkerVersion}}</span></td>
              </tr>
              <tr>
                <td>MinorLinkerVersion</td>
                <td><span class="is-family-code">{{MinorLinkerVersion}}</span></td>
              </tr>
              <tr>
                <td>SizeOfCode</td>
                <td><span class="is-family-code">{{SizeOfCode}}</span></td>
              </tr>
              <tr>
                <td>SizeOfInitializedData</td>
                <td><span class="is-family-code">{{SizeOfInitializedData}}</span></td>
              </tr>
              <tr>
                <td>SizeOfUninitializedData</td>
                <td><span class="is-family-code">{{SizeOfUninitializedData}}</span></td>
              </tr>
              <tr>
                <td>AddressOfEntryPoint</td>
                <td><span class="is-family-code">{{AddressOfEntryPoint}}</span></td>
              </tr>
              <tr>
                <td>BaseOfCode</td>
                <td><span class="is-family-code">{{BaseOfCode}}</span></td>
              </tr>
              <tr>
                <td>ImageBase</td>
                <td><span class="is-family-code">{{ImageBase}}</span></td>
              </tr>
              <tr>
                <td>SectionAlignment</td>
                <td><span class="is-family-code">{{SectionAlignment}}</span></td>
              </tr>
              <tr>
                <td>FileAlignment</td>
                <td><span class="is-family-code">{{FileAlignment}}</span></td>
              </tr>
              <tr>
                <td>MajorOperatingSystemVersion</td>
                <td><span class="is-family-code">{{MajorOperatingSystemVersion}}</span></td>
              </tr>
              <tr>
                <td>MinorOperatingSystemVersion</td>
                <td><span class="is-family-code">{{MinorOperatingSystemVersion}}</span></td>
              </tr>
              <tr>
                <td>MajorImageVersion</td>
                <td><span class="is-family-code">{{MajorImageVersion}}</span></td>
              </tr>
              <tr>
                <td>MinorImageVersion</td>
                <td><span class="is-family-code">{{MinorImageVersion}}</span></td>
              </tr>
              <tr>
                <td>MajorSubsystemVersion</td>
                <td><span class="is-family-code">{{MajorSubsystemVersion}}</span></td>
              </tr>
              <tr>
                <td>MinorSubsystemVersion</td>
                <td><span class="is-family-code">{{MinorSubsystemVersion}}</span></td>
              </tr>
              <tr>
                <td>Win32VersionValue</td>
                <td><span class="is-family-code">{{Win32VersionValue}}</span></td>
              </tr>
              <tr>
                <td>SizeOfImage</td>
                <td><span class="is-family-code">{{SizeOfImage}}</span></td>
              </tr>
              <tr>
                <td>SizeOfHeaders</td>
                <td><span class="is-family-code">{{SizeOfHeaders}}</span></td>
              </tr>
              <tr>
                <td>CheckSum</td>
                <td><span class="is-family-code">{{CheckSum}}</span></td>
              </tr>
              <tr>
                <td>Subsystem
                  <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#windows-subsystem" class="button is-small is-link is-rounded">
                    <span class="icon is-small">
                      <i class="fas fa-question"></i>
                    </span>
                  </a>
                </td>
                <td><span class="is-family-code">{{Subsystem}}</span></td>
              </tr>
              <tr>
                <td>DllCharacteristics
                  <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#dll-characteristics" class="button is-small is-link is-rounded">
                    <span class="icon is-small">
                      <i class="fas fa-question"></i>
                    </span>
                  </a>
                </td>
                <td><span class="is-family-code">{{DllCharacteristics}}</span></td>
              </tr>
              <tr>
                <td>SizeOfStackReserve</td>
                <td><span class="is-family-code">{{SizeOfStackReserve}}</span></td>
              </tr>
              <tr>
                <td>SizeOfStackCommit</td>
                <td><span class="is-family-code">{{SizeOfStackCommit}}</span></td>
              </tr>
              <tr>
                <td>SizeOfHeapReserve</td>
                <td><span class="is-family-code">{{SizeOfHeapReserve}}</span></td>
              </tr>
              <tr>
                <td>SizeOfHeapCommit</td>
                <td><span class="is-family-code">{{SizeOfHeapCommit}}</span></td>
              </tr>
              <tr>
                <td>LoaderFlags</td>
                <td><span class="is-family-code">{{LoaderFlags}}</span></td>
              </tr>
              <tr>
                <td>NumberOfRvaAndSizes</td>
                <td><span class="is-family-code">{{NumberOfRvaAndSizes}}</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </script>
    <!-- Report DOS Header Pane: -->
    <script id="report-dos-template" type="text/template">
      <section id="report-dos" class="section is-hidden">
        <div class="container">
          <h1 class="title">Header</h1>
          <table class="table is-striped is-hoverable is-fullwidth">
            <tbody>
              <tr>
                <td>e_magic</td>
                <td><span class="is-family-code">{{e_magic}}</span></td>
                <td>Magic number ('MZ' in ASCII)</td>
              </tr>
              <tr>
                <td>e_cblp</td>
                <td><span class="is-family-code">{{e_cblp}}</span></td>
                <td>Bytes in last page of file</td>
              </tr>
              <tr>
                <td>e_cp</td>
                <td><span class="is-family-code">{{e_cp}}</span></td>
                <td>Number of pages in file</td>
              </tr>
              <tr>
                <td>e_crlc</td>
                <td><span class="is-family-code">{{e_crlc}}</span></td>
                <td>Relocation items</td>
              </tr>
              <tr>
                <td>e_cparhdr</td>
                <td><span class="is-family-code">{{e_cparhdr}}</span></td>
                <td>Number of paragraphs in header</td>
              </tr>
              <tr>
                <td>e_minalloc</td>
                <td><span class="is-family-code">{{e_minalloc}}</span></td>
                <td>Minimum extra paragraphs needed</td>
              </tr>
              <tr>
                <td>e_maxalloc</td>
                <td><span class="is-family-code">{{e_maxalloc}}</span></td>
                <td>Maximum extra paragraphs needed</td>
              </tr>
              <tr>
                <td>e_ss</td>
                <td><span class="is-family-code">{{e_ss}}</span></td>
                <td>Initial (relative) SS value</td>
              </tr>
              <tr>
                <td>e_sp</td>
                <td><span class="is-family-code">{{e_sp}}</span></td>
                <td>Initial SP value</td>
              </tr>
              <tr>
                <td>e_csum</td>
                <td><span class="is-family-code">{{e_csum}}</span></td>
                <td>Checksum</td>
              </tr>
              <tr>
                <td>e_ip</td>
                <td><span class="is-family-code">{{e_ip}}</span></td>
                <td>Initial IP value</td>
              </tr>
              <tr>
                <td>e_cs</td>
                <td><span class="is-family-code">{{e_cs}}</span></td>
                <td>Initial (relative) CS value</td>
              </tr>
              <tr>
                <td>e_lfarlc</td>
                <td><span class="is-family-code">{{e_lfarlc}}</span></td>
                <td>File address of relocation table</td>
              </tr>
              <tr>
                <td>e_ovno</td>
                <td><span class="is-family-code">{{e_ovno}}</span></td>
                <td>Overlay number</td>
              </tr>
              <tr>
                <td>e_res</td>
                <td><span class="is-family-code">{{e_res}}</span></td>
                <td><strong>Reserved</strong></td>
              </tr>
              <tr>
                <td>e_oemid</td>
                <td><span class="is-family-code">{{e_oemid}}</span></td>
                <td>OEM identifier (for <span class="is-family-code">e_oeminfo</span>)</td>
              </tr>
              <tr>
                <td>e_oeminfo</td>
                <td><span class="is-family-code">{{e_oeminfo}}</span></td>
                <td>OEM information (<span class="is-family-code">e_oemid</span> specific)</td>
              </tr>
              <tr>
                <td>e_res2</td>
                <td><span class="is-family-code">{{e_res2}}</span></td>
                <td><strong>Reserved</strong></td>
              </tr>
              <tr>
                <td>e_lfanew</td>
                <td><span class="is-family-code">{{e_lfanew}}</span></td>
                <td>File address of the PE header</td>
              </tr>
            </tbody>
          </table>
        </div>
        <hr>
        <div class="container">
          <h1 class="title">DOS Stub Program
            <a target="_blank" href="https://docs.microsoft.com/en-us/windows/desktop/Debug/pe-format#ms-dos-stub-image-only" class="button is-small is-link is-rounded">
              <span class="icon is-small">
                <i class="fas fa-question"></i>
              </span>
            </a>
          </h1>
          <pre style="white-space:pre-wrap;word-wrap:break-word" class="is-family-code">{{DOS_STUB}}</pre>
        </div>
        <hr>
        <div class="container">
          <h1 class="title">Reference: Standard DOS Stub Program from GCC Compiler:
            <a target="_blank" href="https://en.wikibooks.org/wiki/X86_Disassembly/Windows_Executable_Files#MS-DOS_header" class="button is-small is-link is-rounded">
              <span class="icon is-small">
                <i class="fas fa-question"></i>
              </span>
            </a>
          </h1>
          <pre class="is-family-monospace">
; Using NASM with Intel Syntax
push cs        ; push CS onto the stack
pop ds         ; set DS to CS

; this means that Data Segment and Code Segment point to the same
; 64k byte area of memory. without this we would not be able
; to load any data.

mov dx,message ; load address of message
mov ah, 09     ; ah = 9 is the DOS interrupt print a string
int 0x21
mov ax,0x4c01  ; terminate the program
int 0x21

; 0Dh is the 'Carriage return' ASCII code
; 0Ah is the 'Line feed' ASCII code
; '$' is the string-terminator in DOS
message db "This program cannot be run in DOS mode.", 0x0d, 0x0d, 0x0a, '$'</pre>
        </div>
        <hr>
        <div class="container">
          <h1 class="title">Reference: Disassembled Version of GCC DOS Stub Program:</h1>
          <pre class="is-family-monospace">
00000000  0E      push cs
00000001  1F      pop ds
00000002  BA0E00  mov dx,0xe
00000005  B409    mov ah,0x9
00000007  CD21    int 0x21
00000009  B8014C  mov ax,0x4c01
0000000C  CD21    int 0x21</pre>
        </div>
      </section>
    </script>
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  </body>
</html>